-----------------------------------------------------------------------
-- An example of Actor Prolog program.                               --
-- (c) 2015 IRE RAS Alexei A. Morozov                                --
-----------------------------------------------------------------------
import .. from "morozov/Webcam";
-----------------------------------------------------------------------
project: (('ControlPanel'))
-----------------------------------------------------------------------
class 'ControlPanel' (specialized 'Dialog'):
--
internal:
--
	watcher			= ('WebcamWatcher',
					report);
	report			= ('Report');
--
constant:
--
	is_top_level_window	= 'yes';
--
[
goal:-!,
	show.
--
modified_control(Address):-
	Address == 1001,
	Mode== ?val("YesNo",?get(Address)),!,
	watcher ? switch_watcher(Mode).
modified_control(Address):-
	Address == 1002,
	Mode== ?val("YesNo",?get(Address)),!,
	watcher ? switch_webcam(Mode).
--
action("clear"):-!,
	report ? clear.
action("exit"):-!,
	hide,
	break.
]
-----------------------------------------------------------------------
class 'WebcamWatcher' (specialized 'Webcam'):
--
internal:
--
	report		: 'Report';
--
[
PREDICATES:
--
imperative:
--
switch_watcher(YesNo)		- (i);
switch_webcam(YesNo)		- (i);
--
CLAUSES:
--
switch_watcher(Mode):-
	watch_webcam_state(Mode).
--
switch_webcam('yes'):-!,
	open.
switch_webcam(_):-
	close.
--
webcam_open(WebcamName):-!,
	report ? set_color('Violet'),
	report ? writeln("This webcam is open: ",WebcamName).
--
webcam_image_obtained(WebcamName):-!,
	report ? set_color('DkGreen'),
	report ? writeln("This webcam has a new image: ",WebcamName).
--
webcam_closed(WebcamName):-!,
	report ? set_color('Orange'),
	report ? writeln("This webcam is closed: ",WebcamName).
--
webcam_disposed(WebcamName):-!,
	report ? set_color('Red'),
	report ? writeln("This webcam is disposed: ",WebcamName).
]
-----------------------------------------------------------------------
